package hgsadc;

import hgsadc.implementations.EducationStandard;
import hgsadc.implementations.FitnessEvaluationStandard;
import hgsadc.implementations.GenoToPhenoConverterStandard;
import hgsadc.implementations.GenotypeHGS;
import hgsadc.implementations.PenaltyAdjustmentProtocol;
import hgsadc.protocols.EducationProtocol;
import hgsadc.protocols.FitnessEvaluationProtocol;
import hgsadc.protocols.GenoToPhenoConverterProtocol;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Set;

public class Test {
	
	public static void main(String[] args) {
		Test test = new Test();
		test.testVoyage();
	}
	
	private void testVoyage() {
		IO io = new IO("data/hgs/input/input data hgs.xls");
		ProblemData problemData = io.readData();
		problemData.generatePatterns();
		FitnessEvaluationProtocol fitnessEvaluationProtocol = new FitnessEvaluationStandard(problemData);
		GenoToPhenoConverterProtocol genoToPhenoProtocol = new GenoToPhenoConverterStandard(problemData);
		PenaltyAdjustmentProtocol penalty = new PenaltyAdjustmentProtocol(0.2);
		EducationStandard education = new EducationStandard(problemData, fitnessEvaluationProtocol, penalty, genoToPhenoProtocol);

		
		//initialize optimal genotype
		ArrayList<Integer> installations1 = new ArrayList<Integer>();
		installations1.add(2);
		installations1.add(3);
		installations1.add(4);
		installations1.add(1);
		installations1.add(9);
		installations1.add(7);
		installations1.add(8);
		installations1.add(13);
		
		ArrayList<Integer> installations2 = new ArrayList<Integer>();
		installations2.add(13);
		installations2.add(8);
		installations2.add(14);
		installations2.add(7);
		installations2.add(6);
		installations2.add(2);
		installations2.add(11);
		
		ArrayList<Integer> installations3 = new ArrayList<Integer>();
		installations3.add(9);
		installations3.add(1);
		installations3.add(3);
		installations3.add(12);
		installations3.add(5);
		installations3.add(4);
		
		ArrayList<Integer> installations4 = new ArrayList<Integer>();
		installations4.add(11);
		installations4.add(8);
		installations4.add(14);
		installations4.add(3);
		installations4.add(4);
		installations4.add(12);
		installations4.add(1);
		installations4.add(9);
		
		ArrayList<Integer> installations5 = new ArrayList<Integer>();
		installations5.add(13);
		installations5.add(8);
		installations5.add(7);
		installations5.add(9);
		installations5.add(4);
		installations5.add(1);
		installations5.add(3);
		installations5.add(2);
		
		ArrayList<Integer> installations6 = new ArrayList<Integer>();
		installations6.add(14);
		installations6.add(7);
		installations6.add(8);
		installations6.add(2);
		installations6.add(9);
		installations6.add(12);
		installations6.add(1);
		installations6.add(11);
		
		ArrayList<Integer> installations7 = new ArrayList<Integer>();
		installations7.add(11);
		installations7.add(2);
		installations7.add(7);
		installations7.add(6);
		installations7.add(12);
		installations7.add(5);
		installations7.add(4);
		
		ArrayList<Integer> installations8 = new ArrayList<Integer>();
		installations8.add(13);
		installations8.add(10);
		installations8.add(8);
		installations8.add(14);
		installations8.add(3);
		installations8.add(1);
		installations8.add(9);
		
		HashMap<Integer, HashMap<Integer, ArrayList<Integer>>> giantTourChromosome =  new HashMap<Integer, HashMap<Integer,ArrayList<Integer>>>();
		
		for (int i = 0; i < 7; i++) {//days
			HashMap<Integer, ArrayList<Integer>> day = new HashMap<Integer, ArrayList<Integer>>();
			for (int j = 1; j < 5; j++) {//vessels
				day.put(j, new ArrayList<Integer>());
			}
			giantTourChromosome.put(i, day);
		}
		
		HashMap<Integer, ArrayList<Integer>> day0 = giantTourChromosome.get(0);
		day0.put(1, installations1);
		
		HashMap<Integer, ArrayList<Integer>> day1 = giantTourChromosome.get(1);
		day1.put(2, installations2);
		day1.put(4, installations3);
		
		HashMap<Integer, ArrayList<Integer>> day2 = giantTourChromosome.get(2);
		day2.put(3, installations4);
	
		HashMap<Integer, ArrayList<Integer>> day3 = giantTourChromosome.get(3);
		day3.put(1, installations5);
		
		HashMap<Integer, ArrayList<Integer>> day4 = giantTourChromosome.get(4);
		day4.put(4, installations6);
		
		HashMap<Integer, ArrayList<Integer>> day5 = giantTourChromosome.get(5);
		day5.put(2, installations7);
		day5.put(3, installations8);
		
		System.out.println("Best found solution");
		
		GenotypeHGS bfGenotype = new GenotypeHGS(giantTourChromosome, 14, 4);
		Individual bfIndividual = new Individual(bfGenotype);
		System.out.println(bfGenotype);
		
		genoToPhenoProtocol.convertGenotypeToPhenotype(bfIndividual);
		fitnessEvaluationProtocol.setPenalizedCostIndividual(bfIndividual);
		System.out.println(bfIndividual.getPenalizedCost());
		
		education.installationPatternSwap(bfIndividual);
		System.out.println(bfIndividual.getPenalizedCost());
		System.out.println(bfIndividual.getPhenotype().getScheduleString());
		
		
	}

}
